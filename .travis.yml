sudo: required
language: python
addons:
  postgresql: "9.5"
python:
  - "2.7"
  - "3.4"
  - "3.5"
install:
  - sudo /etc/init.d/postgresql stop
  - sudo apt-get -y remove --purge postgresql-9.1 postgresql-9.2 postgresql-9.3 postgresql-9.4
  - sudo apt-get -y autoremove
  - sudo apt-key adv --keyserver keys.gnupg.net --recv-keys 7FCC7D46ACCC4CF8
  - sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt/ precise-pgdg main 9.5" >> /etc/apt/sources.list.d/postgresql.list'
  - sudo apt-get update
  - sudo apt-get -y install postgresql-9.5
  - sudo /etc/init.d/postgresql stop
  - if [[ $TRAVIS_PYTHON_VERSION == 2* ]]; then pip install -r requirements-py2.txt --use-mirrors; fi
  - if [[ $TRAVIS_PYTHON_VERSION == 3* ]]; then pip install -r requirements-py3.txt; fi
  - pip install coveralls codacy-coverage
script:
  - python setup.py test
  - python setup.py flake8
  - bash -x acceptance_tests.sh
after_success:
  - coveralls
  - python-codacy-coverage -r coverage.xml
